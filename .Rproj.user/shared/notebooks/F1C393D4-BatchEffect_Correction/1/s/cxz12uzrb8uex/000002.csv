"0","library(rliger)
library(SeuratWrappers)

# Import unfiltered Seurat object (included with 'BatchNorm' package)
data(PBMCs)

# Run ""standard"" Seurat + LIGER workflow:
## ""https://github.com/satijalab/seurat-wrappers/blob/master/docs/liger.md""
# Including filtering by mitochondrial percentage (+5 SD)
# Including data normalization, variable gene selection and gene scaling (performed on all samples together)
PBMCs <- PBMCs %>% 
         MitoFilter() %>% 
         NormalizeData(normalization.method = ""LogNormalize"", assay = ""RNA"", scale.factor = 10000) %>% 
         NormalizeData(verbose = FALSE, assay = ""ADT"", normalization.method = ""CLR"") %>%
         FindVariableFeatures(selection.method = ""vst"", nfeatures = 2000) %>%
         ScaleData(split.by = ""orig.ident"", do.center = FALSE) %>% 
         RunOptimizeALS(k = 20, lambda = 5, split.by = ""orig.ident"") %>% 
         RunQuantileNorm(split.by = ""orig.ident"") %>%
         RunUMAP(dims = 1:14, reduction = ""iNMF"") %>% 
         FindNeighbors(reduction = ""iNMF"", dims = 1:14) %>%
         FindClusters(resolution = 0.8)
"
"2","Performing log-normalization
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"2","Calculating gene variances"
"2","
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"2","Calculating feature variances of standardized and clipped values"
"2","
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"2","  |                                                                                                                                    "
"2","  |                                                                                                                              |   0%"
"2","  |                                                                                                                                    "
"2","  |===============================================================                                                               |  50%"
"2","  |                                                                                                                                    "
"2","  |==============================================================================================================================| 100%"
"2","
"
"2","  |                                                                                                                                    "
"2","  |                                                                                                                              |   0%"
"2","  |                                                                                                                                    "
"2","  |===============================================================                                                               |  50%"
"2","  |                                                                                                                                    "
"2","  |==============================================================================================================================| 100%"
"2","
"
"2","  |                                                                                                                                    "
"2","  |                                                                                                                              |   0%"
"2","  |                                                                                                                                    "
"2","  |===============================================================                                                               |  50%"
"2","  |                                                                                                                                    "
"2","  |==============================================================================================================================| 100%"
"2","
"
"1","  |                                                                                                                                    "
"1","  |                                                                                                                              |   0%"
"1","  |                                                                                                                                    "
"1","  |====                                                                                                                          |   3%"
"1","  |                                                                                                                                    "
"1","  |========                                                                                                                      |   7%"
"1","  |                                                                                                                                    "
"1","  |=============                                                                                                                 |  10%"
"1","  |                                                                                                                                    "
"1","  |=================                                                                                                             |  13%"
"1","  |                                                                                                                                    "
"1","  |=====================                                                                                                         |  17%"
"1","  |                                                                                                                                    "
"1","  |=========================                                                                                                     |  20%"
"1","  |                                                                                                                                    "
"1","  |=============================                                                                                                 |  23%"
"1","  |                                                                                                                                    "
"1","  |==================================                                                                                            |  27%"
"1","  |                                                                                                                                    "
"1","  |======================================                                                                                        |  30%"
"1","  |                                                                                                                                    "
"1","  |==========================================                                                                                    |  33%"
"1","  |                                                                                                                                    "
"1","  |==============================================                                                                                |  37%"
"1","  |                                                                                                                                    "
"1","  |==================================================                                                                            |  40%"
"1","  |                                                                                                                                    "
"1","  |=======================================================                                                                       |  43%"
"1","  |                                                                                                                                    "
"1","  |===========================================================                                                                   |  47%"
"1","  |                                                                                                                                    "
"1","  |===============================================================                                                               |  50%"
"1","  |                                                                                                                                    "
"1","  |===================================================================                                                           |  53%"
"1","  |                                                                                                                                    "
"1","  |=======================================================================                                                       |  57%"
"1","  |                                                                                                                                    "
"1","  |============================================================================                                                  |  60%"
"1","  |                                                                                                                                    "
"1","  |================================================================================                                              |  63%"
"1","  |                                                                                                                                    "
"1","  |====================================================================================                                          |  67%"
"1","  |                                                                                                                                    "
"1","  |========================================================================================                                      |  70%"
"1","  |                                                                                                                                    "
"1","  |============================================================================================                                  |  73%"
"1","  |                                                                                                                                    "
"1","  |=================================================================================================                             |  77%"
"1","  |                                                                                                                                    "
"1","  |=====================================================================================================                         |  80%"
"1","  |                                                                                                                                    "
"1","  |=========================================================================================================                     |  83%"
"1","  |                                                                                                                                    "
"1","  |=============================================================================================================                 |  87%"
"1","  |                                                                                                                                    "
"1","  |=================================================================================================================             |  90%"
"1","  |                                                                                                                                    "
"1","  |======================================================================================================================        |  93%"
"1","  |                                                                                                                                    "
"1","  |==========================================================================================================================    |  97%"
"1","  |                                                                                                                                    "
"1","  |==============================================================================================================================| 100%"
"1","
Finished in "
"1",""
"1","5.810237"
"1",""
"1"," "
"1",""
"1","mins"
"1",""
"1",", "
"1",""
"1","30"
"1",""
"1"," iterations.
"
"1",""
"1","Max iterations set: "
"1",""
"1","30"
"1",""
"1",".
"
"1",""
"1","Final objective delta: "
"1",""
"1","1.118738e-05"
"1",""
"1",".
"
"1","Best results with seed "
"1",""
"1","1"
"1",""
"1",".
"
"2","No columnames present in cell embeddings, setting to 'riNMF_1:20'"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"1",""
"1","Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck"
"1","
"
"1","
"
"1","Number of nodes: 16946
"
"1","Number of edges: 534569
"
"1","
"
"1","Running "
"1","Louvain algorithm"
"1","..."
"1","
"
"2","0%   10   20   30   40   50   60   70   80   90   100%
"
"2","[----|----|----|----|----|----|----|----|----|----|
"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","*"
"2","|
"
"1","Maximum modularity in 10 random starts: 0.8882
"
"1","Number of communities: 24
"
"1","Elapsed time: 1 seconds
"
